2022.07.15 TIL

### ğŸ“Œ Social Login
<br>

![](https://www.freecodecamp.org/news/content/images/size/w2000/2021/10/MzBKTcnJA.jpeg)

ì†Œì…œ ë¡œê·¸ì¸ì€ êµ¬ê¸€, ë„¤ì´ë²„, ì¹´ì¹´ì˜¤ ë“± ì—°ë™ëœ í•´ë‹¹ ì†Œì…œ ê³„ì •ìœ¼ë¡œ ì‚¬ìš©í•  ì•±ì— ë¡œê·¸ì¸ì„ í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

2019ë…„ ì• í”Œì€ <span style="background-color:#FFF5B1">ì• í”Œ ë¡œê·¸ì¸</span> ê¸°ëŠ¥ì„ ë°œí‘œí–ˆìŠµë‹ˆë‹¤. ê·¸ì™€ ë™ì‹œì— **ì•± ë‚´ì—ì„œ ë‹¤ë¥¸ ì†Œì…œ ë¡œê·¸ì¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë°˜ë“œì‹œ ì• í”Œ ë¡œê·¸ì¸ì„ í¬í•¨í•´ì•¼ í•œë‹¤**ëŠ” ì‹¬ì‚¬ì§€ì¹¨ë„ í•¨ê»˜ ì—…ë°ì´íŠ¸í–ˆì–´ìš”.

> iOS 13.0 ì´ìƒë§Œ ì• í”Œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ“Œ ì• í”Œ ë¡œê·¸ì¸
**Apple Developer Program ì‹¬ì‚¬ì¤‘..**

### ğŸ“Œ ì¹´ì¹´ì˜¤ ê³„ì • ë¡œê·¸ì¸

ì¹´ì¹´ì˜¤ì—ì„œëŠ” [ê°€ì´ë“œ ë¬¸ì„œ](https://developers.kakao.com/docs/latest/ko/kakaologin/ios)ë¥¼ í†µí•´ ì†Œì…œ ë¡œê·¸ì¸ì— ëŒ€í•œ ê°€ì´ë“œë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.

#### **0ï¸âƒ£ ìš”êµ¬ ì‚¬ì–‘**
iOS SDKë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ìµœì†Œ ìš”êµ¬ ì‚¬ì–‘ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
- Xcode 11.0 ì´ìƒ
- iOS 11.0 ì´ìƒ
- iOS Deployment Target 11.0 ì´ìƒ
- Swift 5.0 ì´ìƒ

#### **1ï¸âƒ£ ë²„íŠ¼ ë‹¤ìš´ë°›ê¸°**
ë¨¼ì € ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì— ì‚¬ìš©í•  ë²„íŠ¼ ì´ë¯¸ì§€ëŠ” [ë§í¬](https://developers.kakao.com/tool/resource/login)ì—ì„œ ì œê³µí•©ë‹ˆë‹¤. í•„ìš”ì— ë”°ë¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, [ë””ìì¸ ê°€ì´ë“œ](https://developers.kakao.com/docs/latest/ko/reference/design-guide#login-button)ë¥¼ ê¼­ ì§€ì¼œì•¼ í•©ë‹ˆë‹¤!

![](https://developers.kakao.com/docs/latest/ko/assets/style/images/design-guide/login-button-example-color.png)
ë””ìì¸ ê°€ì´ë“œë¥¼ ì¤€ìˆ˜í•˜ì§€ ì•Šì€ ë²„íŠ¼ ì‚¬ìš©ì„ ê¸ˆì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.


#### **2ï¸âƒ£ êµ¬í˜„ ë°©ì‹ ì„ íƒí•˜ê¸°**
ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ êµ¬í˜„ ë°©ë²•ì€ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸ê³¼ ì¹´ì¹´ì˜¤ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ê¶Œì¥ ì‚¬í•­ì¸ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸ìœ¼ë¡œ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-16 á„‹á…©á„’á…® 10 19 36](https://user-images.githubusercontent.com/63997044/179356625-f58ee200-34f6-4cb3-8a8d-6eb65d4a6d94.png)


#### **3ï¸âƒ£ í•„ìš”í•œ ëª¨ë“ˆ ì„¤ì¹˜í•˜ê¸°**
ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ APIë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìš”í•œ ëª¨ë“ˆì„ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒ ëª¨ë“ˆì„ ì„¤ì¹˜í•˜ê³  `import`í•©ë‹ˆë‹¤. SPMì„ í†µí•´ https://github.com/kakao/kakao-ios-sdk ì—ì„œ ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```swift
import KakaoSDKCommon
import KakaoSDKAuth
import KakaoSDKUser
```

#### **4ï¸âƒ£ ì„¤ì •í•˜ê¸°**
1. í”Œë«í¼ ë“±ë¡í•˜ê¸°
ì¹´ì¹´ì˜¤ APIë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ê°œë°œì ì›¹ì‚¬ì´íŠ¸ì— ì•±ì„ ë“±ë¡í•´ì•¼ í•©ë‹ˆë‹¤. [ê°€ì´ë“œ](https://developers.kakao.com/docs/latest/ko/getting-started/app#platform-ios)ë¥¼ ë”°ë¼ í”Œë«í¼ì„ ë“±ë¡í•©ë‹ˆë‹¤.

- 1-1. [kakao developers](https://developers.kakao.com/console/app) > ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ > ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€í•˜ê¸°

- 1.2. ì¶”ê°€í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë¦­ > í”Œë«í¼ > iOS í”Œë«í¼ ë“±ë¡
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-16 á„‹á…©á„’á…® 10 51 13](https://user-images.githubusercontent.com/63997044/179357724-76b13998-2bdc-4670-9e41-d8f2cd33129c.png)

- 1.3. ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ > í™œì„±í™” ì„¤ì • > ìƒíƒœ ON
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-16 á„‹á…©á„’á…® 10 49 21](https://user-images.githubusercontent.com/63997044/179357650-8389c81a-5ecd-46e5-9011-e56c3bebe689.png)
ë°”ë¡œ ì•„ë˜ ë©”ë‰´ì¸ ë™ì˜í•­ëª©ì—ì„œ ë™ì˜ë°›ëŠ” í•­ëª©ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—°ìŠµì´ë‹ˆê¹Œ ì•„ë¬´ê±°ë‚˜ ë§ì´ ë„£ì–´ë´¤ì–´ìš”.
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-16 á„‹á…©á„’á…® 10 47 14](https://user-images.githubusercontent.com/63997044/179357616-ba48ecc3-25a2-42e4-b9cb-7d87fcde8e42.png)

2. ì•± ì‹¤í–‰ í—ˆìš© ëª©ë¡ ì„¤ì •í•˜ê¸°
- iOS SDKë¥¼ í†µí•´ ì¹´ì¹´ì˜¤ ì„œë¹„ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¤ë ¤ë©´ ì•± ì‹¤í–‰ í—ˆìš© ëª©ë¡ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. 
- [Info] > [Custom iOS Target Properties]ì— Array íƒ€ì… í‚¤(Key)ì¸ LSApplicationQueriesSchemesë¥¼ ì¶”ê°€í•˜ê³ , í•´ë‹¹ í‚¤ì˜ [Item]ìœ¼ë¡œ ì»¤ìŠ¤í…€ URL ìŠ¤í‚´ì— ì‚¬ìš©í•  ê°’ì¸ "kakaokompassauth", "kakaolink"ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-07-16 á„‹á…©á„’á…® 10 58 54](https://user-images.githubusercontent.com/63997044/179357991-be1d8afa-bdc3-4c51-8e7b-1dc935f9759f.png)

3. URL Scheme ì„¤ì •í•˜ê¸°
- ì¹´ì¹´ì˜¤í†¡ ì¸ì¦ ìš”ì²­ ë°œìƒ ì‹œ ì¹´ì¹´ì˜¤í†¡ ì•± ì‹¤í–‰ì„ ìœ„í•´ URL Schemeì„ ì„¤ì •í•©ë‹ˆë‹¤.
- Info > URL types > URL Schemes í•­ëª©ì— ì•„ê¹Œ ì•±ì„ ë“±ë¡í–ˆì„ ë•Œ ë‚˜ì˜¨ ë„¤ì´í‹°ë¸Œ ì•± í‚¤ë¥¼ 'kakao{NATIVE_APP_KEY}' í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•©ë‹ˆë‹¤.
- ë§Œì•½ ë„¤ì´í‹°ë¸Œ ì•± í‚¤ê°€ '123456789'ì´ë¼ë©´ 'kakao123456789'ì„ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.
![](https://developers.kakao.com/docs/latest/ko/assets/style/images/getting-started/getting_started_ios_plist_02.png)

4. ì´ˆê¸°í™”í•˜ê¸°
- ë„¤ì´í‹°ë¸Œ ì•± í‚¤ë¥¼ ì‚¬ìš©í•´ iOS SDKë¥¼ ì´ˆê¸°í™”í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. AppDelegate.swiftì— ë‹¤ìŒ ì½”ë“œë¥¼ ì‚½ì…í•©ë‹ˆë‹¤.
```swift
import KakaoSDKCommon

func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {
    ...
    KakaoSDK.initSDK(appKey: "123456789")
    ...
}
```

5. ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸ì„ ìœ„í•œ ì„¤ì •
- ì¹´ì¹´ì˜¤í†¡ì—ì„œ ì„œë¹„ìŠ¤ ì•±ìœ¼ë¡œ ëŒì•„ì™”ì„ ë•Œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì²˜ë¦¬ë¥¼ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œí•˜ê¸° ìœ„í•œ ì‘ì—…ì…ë‹ˆë‹¤. ì´ ë¶€ë¶„ì´ ì—†ë‹¤ë©´ ì•±ìœ¼ë¡œ ëŒì•„ì™”ì„ ë•Œ ì¸ì¦ ì™„ë£Œê°€ ì§„í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- SceneDelegate.swiftì— ë‹¤ìŒ ì½”ë“œë¥¼ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.
```swift
func scene(_ scene: UIScene, openURLContexts URLContexts: Set<UIOpenURLContext>) {
    if let url = URLContexts.first?.url {
        if (AuthApi.isKakaoTalkLoginUrl(url) {
            _ = AuthController.handleOpenUrl(url: url)
        }
    }
}
```

### **5ï¸âƒ£ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸ êµ¬í˜„**
- ì„¤ì •ì´ ëë‚¬ìœ¼ë‹ˆ ì½”ë“œë¡œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•©ë‹ˆë‹¤.
- ë‹¤ìŒ ì½”ë“œëŠ” ë¡œê·¸ì¸ ë²„íŠ¼ì— ëŒ€í•œ ì´ë²¤íŠ¸ êµ¬í˜„ìœ¼ë¡œ `ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¡œê·¸ì¸ ì‹œë„` í›„ ì„±ê³µí•˜ë©´ ì‚¬ìš©ìì—ê²Œ `Alert`ì„ ë„ì›Œì£¼ëŠ” ì½”ë“œì…ë‹ˆë‹¤.
- `UserApi`ì˜ `loginWithKakaoTalk` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ë¡œê·¸ì¸ì„ ìš”ì²­í•©ë‹ˆë‹¤.
- `let token = token?.accessToken`ì™€ ê°™ì´ ì ‘ê·¼ í† í°ì„ ì–»ì–´ ì„œë¹„ìŠ¤ ì•±ì—ì„œ ì ‘ê·¼í† í°ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì‚¬ìš©ìëŠ” í•„ìˆ˜ í•­ëª©ì— ëª¨ë‘ ë™ì˜í•˜ì—¬ì•¼ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¼ë¡  ì·¨ì†Œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- ë¡œê·¸ì¸ ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ì£¼ìš” ì—ëŸ¬ëŠ” `KakaoSDKCommon` > `AuthFailureReason`ì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
    - case Unknown: ê¸°íƒ€ ì—ëŸ¬
    - case InvalidRequest: ìš”ì²­ íŒŒë¼ë¯¸í„° ì˜¤ë¥˜
    - case InvalidClient: ìœ íš¨í•˜ì§€ ì•Šì€ ì•±
    - case InvalidScope: ìœ íš¨í•˜ì§€ ì•Šì€ scope
    - case InvalidGrant: ì¸ì¦ ìˆ˜ë‹¨ì´ ìœ íš¨í•˜ì§€ ì•Šì•„ ì¸ì¦í•  ìˆ˜ ì—†ëŠ” ìƒíƒœ
    - case Misconfigured: ì„¤ì •ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ. ì˜ˆ) bundle id
    - case Unauthorized: ì•±ì´ ìš”ì²­ ê¶Œí•œì´ ì—†ìŒ
    - case AccessDenied: ì ‘ê·¼ì´ ê±°ë¶€ ë¨ (ë™ì˜ ì·¨ì†Œ)
    - case ServerError: ì„œë²„ ë‚´ë¶€ ì—ëŸ¬
    - case AutoLogin: nodoc: ì¹´ì¹´ì˜¤ì‹±í¬ ì „ìš©
```swift
@IBAction func loginButtonTapped(_ sender: Any) {
    if UserApi.isKakaoTalkLoginAvailable() {
        UserApi.shared.loginWithKakaoTalk { token, error in
        if let error = error {
            print(error.localizedDescription)
        } else {
            let alertController = UIAlertController(title: "ì„±ê³µ", message: "ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤.", preferredStyle: .alert)
            
            let action = UIAlertAction(title: "í™•ì¸", style: .default) { _ in
            //let accessToken = token?.accessToken
            }
            alertController.addAction(action)
            self.present(alertController, animated: true)
        }       
    }
}
```

### **6ï¸âƒ£ ë¡œê·¸ì¸í•œ ê³„ì •ì˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸°**
- `UserApi`ì˜ `me()`ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
- `User`íƒ€ì…ì˜ `kakaoAccount`ë¥¼ í†µí•´ ë¡œê·¸ì¸ëœ ì¹´ì¹´ì˜¤ê³„ì •ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```swift
UserApi.shared.me { user, error in
    if let error = error {
        print(error.localizedDescription)
    } else {
        let nickname = user?.kakaoAccount?.profile?.nickname
        let email = user?.kakaoAccount?.email
        ....
    }
}
```